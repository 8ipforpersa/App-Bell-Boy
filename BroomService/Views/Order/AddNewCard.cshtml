@model BroomService.ViewModels.CardViewModel
<!-- Choose Service box -->
<section id="add_payment_boxes" class="add_payment_boxes">
    <div class="container">
        <div class="add_payment_form">
            <form class="row" id="AddCardForm">
                <div class="col-md-6">
                    <h4>Add New Card</h4>
                    <div class="row">
                        <div class="col-12">
                            <div class="form-group">
                                <label class="property_label">Name As on Card</label>
                                <div class="custom_input">
                                    @Html.HiddenFor(m => m.CardId, new { id = "cardId" })
                                    @Html.TextBoxFor(m => m.NameOnCard, new { @class = "form-control form_edit_input", placeholder = "Ex. James", required = "required", id = "name" })
                                    @*<input type="text" class="form-control form_edit_input" name="name" value="" id="name" placeholder="Ex. James" required>*@
                                </div>
                            </div>
                        </div>
                        <div class="col-12">
                            <div class="form-group">
                                <label class="property_label">E-mail</label>
                                <div class="custom_input">
                                    @Html.TextBoxFor(m => m.Email, new { @class = "form-control form_edit_input", type = "email", placeholder = "Ex. user@gmail.com", required = "required", id = "email" })
                                    @*<input type="email" class="form-control form_edit_input" name="email" id="email" placeholder="Ex. user@gmail.com" required>*@
                                </div>
                            </div>
                        </div>
                        <div class="col-12">
                            <div class="form-group">
                                <label class="property_label">Card Number</label>
                                <div class="custom_input">
                                    @Html.TextBoxFor(m => m.CardNumber, new { @class = "form-control form_edit_input", onKeyPress = "if(this.value.length==16) return false;", placeholder = "Ex. 1234567890", required = "required", id = "cardnumber" })
                                    @*<input type="number" class="form-control form_edit_input number_count"  onKeyPress="if(this.value.length==16) return false;" name="card number" id="cardnumber" placeholder="Ex. 1234567890" required>*@
                                </div>
                            </div>
                        </div>
                        <div class="col-12">
                            <div class="form-group">
                                <label class="property_label">Cvv</label>
                                <div class="custom_input">
                                    @Html.TextBoxFor(m => m.CVV, new { @class = "form-control form_edit_input", onKeyPress = "if(this.value.length==3) return false;", placeholder = "Ex.000", required = "required", id = "cvv" })
                                    @*<input type="number" class="form-control form_edit_input number_count" name="cvv" id="cvv" onKeyPress="if(this.value.length==3) return false;" placeholder="Ex.000" required>*@
                                </div>
                            </div>
                        </div>
                        <div class="col-12">
                            <div class="form-group">
                                <label class="property_label">Expiration (MM/YYYY)</label>
                                <div class="row">
                                    <div class="col-6">
                                        <div class="custom_input">
                                            @Html.TextBoxFor(m => m.ExpireMonth, new { @class = "form-control form_edit_input", onKeyPress = "if(this.value.length==2) return false;", placeholder = "MM", required = "required", id = "expiremonth" })
                                            @*<input type="number" class="form-control form_edit_input number_count"  onKeyPress="if(this.value.length==2) return false;" name="month" id="expiremonth" placeholder="MM" required>*@
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <div class="custom_input">
                                            @Html.TextBoxFor(m => m.ExpireYear, new { @class = "form-control form_edit_input", onKeyPress = "if(this.value.length==4) return false;", placeholder = "YYYY", required = "required", id = "expireyear" })
                                            @*<input type="number" class="form-control form_edit_input number_count" onKeyPress="if(this.value.length==4) return false;" name="year" id="expireyear" placeholder="YYYY" required>*@
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                @*<div class="col-md-6">
                        <div class="right_box_job_details">
                            <h3>Luxury Apartment</h3>
                            <div class="type_propety_box">
                                Type of Property: <span>House\Appartment </span>
                            </div>
                            <div class="type_service_box_2">Short Term Airbnb Apartment</div>
                            <div class="property_box_location d-flex">
                                <img src="~/Content/images/pro_location.png" alt="location">
                                <div class="location_value align-self-top">Allenby St 12, Tel Aviv-Yafo, </div>
                            </div>
                            <div class="row">
                                <div class="col-12 mb-4">
                                    <div class="list_review_services">
                                        <div class="d-block d-sm-flex d-md-block d-lg-flex">
                                            <div class="service_image_main">
                                                <div class="service_image_box">
                                                    <img class="image_unselect" src="~/Content/images/services/professonial_service_un_select.png" alt="service">
                                                    <img class="image_select" src="~/Content/images/services/professonial_service_select.png" alt="service">
                                                </div>
                                            </div>
                                            <div class="servies_details align-self-center">
                                                <h3>Professional Cleaning &amp; Closet Organization</h3>
                                                <p class="service_content">3-Feb-2020, 9:00-11:00</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-12 mb-4">
                                    <div class="list_review_services">
                                        <div class="d-block d-sm-flex d-md-block d-lg-flex">
                                            <div class="service_image_main">
                                                <div class="service_image_box">
                                                    <img class="image_unselect" src="~/Content/images/services/fix_instal_un_select.png" alt="service">
                                                    <img class="image_select" src="~/Content/images/services/fix_instal_select.png" alt="service">
                                                </div>
                                            </div>
                                            <div class="servies_details align-self-center">
                                                <h3>Windows Cleaning</h3>
                                                <p class="service_content">3-Feb-2020, 9:00-11:00</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>*@
                <div class="col-12 d-block d-md-flex m-t-b justify-content-between">
                    <div class="custom-controls-stacked d-block d-sm-flex align-item-center">
                        <label class="custom-control fill-checkbox">
                            <input type="checkbox" class="fill-control-input" id="agreement" onclick="aggreement()">
                            <span class="fill-control-indicator"></span>
                            <span class="fill-control-description">Please accept the terms & conditions to add job request.</span>
                        </label>
                    </div>
                    <div class="back_next_box">
                        <button type="button" onclick="javascript: history.back();" class="btn arrow_btn_box submit_back"><img src="~/Content/images/submit_next_btn.png" alt="next arrow" /></button>
                        <button type="submit" class="btn arrow_btn_box ml-3" id="btnSave"><img src="~/Content/images/submit_next_btn.png" alt="next arrow" /></button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</section>

<script>
    function aggreement() {
        var aggreement = $('#agreement').is(':checked');
        if (aggreement) {
            $('#btnSave').prop('disabled', false);
        }
        else {
            $('#btnSave').prop('disabled', true);
        }

    }

    $(document).ready(function () {
        $('#btnSave').prop('disabled', true);
    });

   $("#AddCardForm").submit(function (e) {
            e.preventDefault();
             AddCard();
    });


    function AddCard() {
        var cardId = $("#cardId").val();
        var name = $("#name").val();
        var email = $("#email").val();
        var cardnumber = $("#cardnumber").val();
        var cvv = $("#cvv").val();
        var expiremonth = $("#expiremonth").val();
        var expireyear = $("#expireyear").val();

        //alert(name + aggreement)

                    $.ajax({
                        url: "@Url.Action("AddCard", "Order")",
                        data: { "CardId": cardId, "name": name, "email": email, "cardnumber": cardnumber, "cvv": cvv, "expiremonth": expiremonth, "expireyear": expireyear },
                        dataType: "json",
                        type: "Post",
                        error: function () {},
                        success: function (data) {
                            if (data.status) {
                                 window.location.href = "/Order/CardsList";
                            }                            
                            else {
                                alert(data.message);
                            }
                          }
                    });
                $('#btnSave').prop('disabled', true);

    }


</script>
